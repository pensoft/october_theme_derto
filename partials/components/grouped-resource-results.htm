{% if groupedResults|length > 0 %}
    <div class="grouped-results">
        {% for topicSlug, topic in groupedResults %}
            <div class="row topic-section">
                <div class="col-xs-12 topic-header">
                    <div class="topic-bubble">Topic</div>
                    <h3 class="topic-title">
                        <a href="/topic/{{ topic.slug }}">{{ topic.name }}</a>
                    </h3>
                </div>
                
                <div class="col-xs-12">
                    <div class="blocks-grid">
                        {% if topic.blocks|length > 0 %}
                            <div class="row">
                            {% for blockId, block in topic.blocks %}
                                <div class="col-xs-12">
                                    <div class="row">
                                        <div class="col-xs-1 block-number">
                                            {{ loop.index }}
                                        </div>
                                        <div class="col-xs-11">
                                            <a href="#" class="block-header">
                                                <h3 class="block-title">{{ block.name }}</h3>
                                                <i class="block-arrow"></i>
                                            </a>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-xs-1"></div>
                                        <div class="col-xs-11">
                                            <div class="block-materials-container">
                                                {% if block.materials|length > 0 %}
                                                    <div class="row">
                                                        {% for material in block.materials %}
                                                            <div class="col-md-4 col-xs-12">
                                                                {% partial 'components/material-card' material=material %}
                                                            </div>
                                                        {% endfor %}
                                                    </div>
                                                {% else %}
                                                    <div class="no-materials">
                                                        <p>No materials found in this block.</p>
                                                    </div>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                            </div>
                        {% else %}
                            <div class="no-blocks-found">
                                <p>No blocks available for this topic.</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
{% else %}
    <div class="no-results">
        <p>Use the filters above to search for course materials. Results will be organized by topic and blocks.</p>
    </div>
{% endif %} 